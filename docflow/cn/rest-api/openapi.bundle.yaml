openapi: 3.0.0
info:
  title: DocFlow API
  description: DocFlow REST API，提供文件上传和获取文件处理结果能力
  version: 2.0.0
servers:
  - url: 'https://docflow.textin.com'
x-codeSamples: custom
paths:
  /api/app-api/sip/platform/v2/file/upload:
    post:
      summary: 上传文件
      description: ''
      operationId: uploadFile
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/Category'
        - $ref: '#/components/parameters/BatchNumber'
        - $ref: '#/components/parameters/AutoVerifyVat'
        - $ref: '#/components/parameters/SplitFlag'
        - $ref: '#/components/parameters/CropFlag'
        - $ref: '#/components/parameters/TargetProcess'
        - $ref: '#/components/parameters/ParserRemoveWatermark'
        - $ref: '#/components/parameters/ParserCropDewarp'
        - $ref: '#/components/parameters/ParserApplyMerge'
        - $ref: '#/components/parameters/ParserFormulaLevel'
        - $ref: '#/components/parameters/ParserTableTextSplitMode'
      requestBody:
        $ref: '#/components/requestBodies/FileUploadRequestBody'
      responses:
        '200':
          description: 文件上传成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          batch_number:
                            type: string
                            description: 批次编号
                            example: 202412190001
                          files:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                  description: 文件ID
                                  example: 202412190001
                                task_id:
                                  type: string
                                  description: 任务ID
                                  example: 1981692246135111700
                                name:
                                  type: string
                                  description: 文件名
                                  example: invoice.pdf
                                format:
                                  type: string
                                  description: 文件格式
                                  example: pdf
                              required:
                                - id
                                - name
                                - format
                        required:
                          - batch_number
                          - files
  /api/app-api/sip/platform/v2/file/upload/sync:
    post:
      summary: 同步上传文件
      description: 同步上传文件并等待处理完成，返回处理结果
      operationId: uploadFileSync
      parameters:
        - $ref: '#/components/parameters/WorkspaceId'
        - $ref: '#/components/parameters/Category'
        - $ref: '#/components/parameters/BatchNumber'
        - $ref: '#/components/parameters/AutoVerifyVat'
        - $ref: '#/components/parameters/SplitFlag'
        - $ref: '#/components/parameters/CropFlag'
        - $ref: '#/components/parameters/TargetProcess'
        - $ref: '#/components/parameters/ParserRemoveWatermark'
        - $ref: '#/components/parameters/ParserCropDewarp'
        - $ref: '#/components/parameters/ParserApplyMerge'
        - $ref: '#/components/parameters/ParserFormulaLevel'
        - $ref: '#/components/parameters/ParserTableTextSplitMode'
        - $ref: '#/components/parameters/WithTaskDetailUrl'
      requestBody:
        $ref: '#/components/requestBodies/FileUploadRequestBody'
      responses:
        '200':
          description: 文件上传并处理成功
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - $ref: '#/components/schemas/TaskProcessResult'
  /api/app-api/sip/platform/v2/file/fetch:
    get:
      summary: 获取文件处理结果列表
      description: ''
      operationId: getFiles
      parameters:
        - name: page
          in: query
          description: 页码，默认1
          required: false
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          description: 每页数量，默认1000
          required: false
          schema:
            type: integer
            default: 1000
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
        - name: batch_number
          in: query
          description: 批次编号
          required: false
          schema:
            type: string
        - name: file_id
          in: query
          description: 文件ID
          required: false
          schema:
            type: string
        - name: category
          in: query
          description: 文件类别
          required: false
          schema:
            type: string
        - name: recognition_status
          in: query
          required: false
          schema:
            $ref: '#/components/schemas/RecognitionStatus'
        - name: verification_status
          in: query
          description: '文件核对状态 0: 待核对 2: 已确认 3: 已拒绝 4: 已删除 5: 推迟处理'
          required: false
          schema:
            $ref: '#/components/schemas/VerificationStatus'
        - name: start_time
          in: query
          description: '以更新时间搜索的开始时间, RFC3339格式(YYYY-MM-DDTHH:MM:SSZ)'
          required: false
          schema:
            type: string
            format: date-time
            example: 2024-01-01T00:00:00.000Z
        - name: end_time
          in: query
          description: '以更新时间搜索的结束时间, RFC3339格式(YYYY-MM-DDTHH:MM:SSZ)'
          required: false
          schema:
            type: string
            format: date-time
            example: 2024-01-01T10:00:00.000Z
        - name: with_document
          in: query
          description: 是否返回文档的全部文字识别结果
          required: false
          schema:
            type: boolean
            default: false
        - name: with_task_detail_url
          in: query
          description: 是否返回任务详情页URL
          required: false
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: 成功获取文件列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - $ref: '#/components/schemas/TaskProcessResult'
  /api/app-api/sip/platform/v2/file/update:
    post:
      summary: 更新文件处理结果
      description: 更新文件处理结果。通常用于人工审核校对后，上传修改后的key-value，覆盖自动识别的结果。
      operationId: updateFile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                type: object
                properties:
                  workspace_id:
                    type: string
                    description: 空间ID
                    example: 1234567890
                  file_id:
                    type: string
                    description: 文件ID
                    example: 202412190001
                  data:
                    description: |
                      全量更新字段。  
                      注意，即使只更新部分字段，也必须包含所有字段。  
                      如果传入的字段较原字段多，则多出的字段会被添加。  
                      如果传入的字段较原字段少，则缺少的字段会被删除。  
                      如果传入的字段值较原字段值有变化，则字段值会被更新。  
                      如果传入的字段与原字段完全相同，则字段会被保留。
                    type: object
                    properties:
                      fields:
                        type: array
                        items:
                          $ref: '#/components/schemas/KeyValue'
                        example:
                          - key: 发票代码
                            value: '3100231130'
                            position:
                              - page: 0
                                vertices:
                                  - 0
                                  - 0
                                  - 100
                                  - 0
                                  - 100
                                  - 100
                                  - 0
                                  - 100
                          - key: 发票号码
                            value: '28737000'
                            position:
                              - page: 0
                                vertices:
                                  - 0
                                  - 0
                                  - 100
                                  - 0
                                  - 100
                                  - 100
                                  - 0
                                  - 100
                      items:
                        type: array
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/KeyValue'
                        example:
                          - - key: 货物劳务名称
                              value: ＊电子计算机＊微型计算机主机
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                            - key: 规格型号
                              value: DMS-SC68
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                          - - key: 货物劳务名称
                              value: ＊机械计算机＊巨型计算机主机
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                            - key: 规格型号
                              value: AN/FSQ-7
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                required:
                  - workspace_id
                  - file_id
                  - data
      responses:
        '200':
          description: 成功更新文件处理结果
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          files:
                            description: 更新后的文件列表
                            type: array
                            items:
                              type: object
                              properties:
                                workspace_id:
                                  type: string
                                  description: 空间ID
                                  example: 1234567890
                                id:
                                  type: string
                                  description: 文件ID
                                  example: 202412190001
      x-codeSamples:
        - lang: bash
          label: cURL
          source: >
            curl -X POST \

            -H 'x-ti-app-id: 1234567890' \

            -H 'x-ti-secret-code: 1234567890' \

            -d '[{"workspace_id": "1234567890", "file_id": "202412190001",
            "data": {"fields": [{"key": "发票代码", "value": "3100231130"}]}}]' \

            'https://docflow.textin.com/api/app-api/sip/platform/v2/file/update'
  /api/app-api/sip/platform/v2/file/delete:
    post:
      summary: 删除任务
      description: 按条件删除文件，满足任一条件即可删除。
      operationId: deleteFile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: 1234567890
                batch_number:
                  type: array
                  items:
                    type: string
                  description: 批次编号列表
                  example:
                    - '202412190001'
                    - '202412190002'
                task_id:
                  type: array
                  items:
                    type: string
                  description: 任务ID列表
                  example:
                    - '1978297791713619968'
                    - '1978297791713619969'
                file_id:
                  type: array
                  items:
                    type: string
                  description: 文件ID列表
                  example:
                    - '1978297792124661760'
                    - '1978297792124661761'
                start_time:
                  type: integer
                  description: 开始时间（epoch时间戳，单位：秒）
                  example: 1760523600
                end_time:
                  type: integer
                  description: 结束时间(epoch时间戳，单位：秒)
                  example: 1760523600
              required:
                - workspace_id
      responses:
        '200':
          description: 成功删除任务
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          deleted_count:
                            type: integer
                            description: 删除的文件数量
                            example: 1
  /api/app-api/sip/platform/v2/file/extract_fields:
    post:
      summary: 抽取特定字段
      description: |
        针对已经完成抽取的任务，为该任务抽取额外的字段，或重新抽取个别已有的字段。  
        返回所有字段的完整抽取结果。返回结构同`/api/app-api/sip/platform/v2/file/fetch`。
      operationId: extractFields
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: 1234567890
                task_id:
                  type: string
                  description: 任务ID
                  example: 1234567890
                fields:
                  type: array
                  items:
                    $ref: '#/components/schemas/ExtractFieldReqVO'
                tables:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                        description: 表格名称
                        example: Table1
                      fields:
                        type: array
                        items:
                          $ref: '#/components/schemas/ExtractFieldReqVO'
              required:
                - workspace_id
                - task_id
      responses:
        '200':
          description: 成功提取字段
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - $ref: '#/components/schemas/TaskProcessResult'
  /api/app-api/sip/platform/v2/file/retry:
    post:
      summary: 重新处理文件
      description: 重新处理文件。
      operationId: retryFile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: 1234567890
                task_id:
                  type: string
                  description: 任务ID
                  example: 1234567890
                parser_params:
                  $ref: '#/components/schemas/DocumentParserParam'
              required:
                - workspace_id
                - task_id
      responses:
        '200':
          description: 成功重新处理文件
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/file/amend_category:
    post:
      summary: 修改文件类别
      description: |
        - 对于普通任务，修改普通任务文件类别
        - 对于文档拆分任务，修改拆分后的文件类型和页码
        - 对于多图切分任务，修改切分后的文件类型
      operationId: amendCategory
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: 1234567890
                task_id:
                  type: string
                  description: 任务ID
                  example: 1234567890
                category:
                  type: string
                  description: |
                    新文件类别。
                    只有当任务类型为普通任务时，才支持更新文件类别。
                  example: 电子发票（普通发票）
                split_tasks:
                  description: 文件拆分任务列表
                  type: array
                  items:
                    type: object
                    properties:
                      category:
                        type: string
                        description: 子任务文件类别
                        example: 电子发票（普通发票）
                      pages:
                        type: array
                        items:
                          type: integer
                          description: 子文件页码，从0开始计数
                        example:
                          - 0
                          - 1
                crop_tasks:
                  description: 多图切分任务列表
                  type: array
                  items:
                    type: object
                    properties:
                      crop_child_task_id:
                        type: string
                        description: 多图切分子任务ID
                        example: 1234567890
                      category:
                        type: string
                        description: 子任务文件类别
                        example: 电子发票（普通发票）
              required:
                - workspace_id
                - task_id
      responses:
        '200':
          description: 成功更新文件类别
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/auth/token:
    get:
      summary: 生成短时间有效的token
      description: 生成短时间有效的token(用于iframe场景)
      operationId: authToken
      responses:
        '200':
          description: 成功获取文件列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - $ref: '#/components/schemas/TokenResult'
  /api/app-api/sip/platform/v2/workspace/create:
    post:
      summary: 创建空间
      description: 创建一个新的工作空间
      operationId: createWorkspace
      tags:
        - 空间管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: 空间名称
                  example: 我的工作空间
                  maxLength: 50
                description:
                  type: string
                  description: 空间描述
                  example: 这是一个用于处理发票的工作空间
                  maxLength: 200
                enterprise_id:
                  type: integer
                  format: int64
                  description: 企业组织ID
                  example: 12345
                manage_account_id:
                  type: integer
                  format: int64
                  description: 空间管理员id
                  example: 67890
                account_id:
                  type: integer
                  format: int64
                  description: 当前账号ID
                  example: 98765
                auth_scope:
                  type: integer
                  description: 协作范围 0:仅自己可见 1:企业成员可见
                  example: 1
                  enum:
                    - 0
                    - 1
                enable_mail_collection_status:
                  type: boolean
                  description: 启用邮箱收票状态 false:禁用 true:启用
                  example: true
                mail_inbox_address:
                  type: string
                  description: 收件箱地址
                  example: workspace@example.com
                init_status:
                  type: boolean
                  description: 是否为初始化空间
                  default: false
                  example: false
                workspace_type:
                  type: integer
                  description: 工作空间类型 0：个人 1：团队
                  example: 1
                  enum:
                    - 0
                    - 1
                demo_status:
                  type: integer
                  description: 是否为demo工作空间 0：否 1：是
                  default: 0
                  example: 0
                  enum:
                    - 0
                    - 1
                task_clone_flag:
                  type: boolean
                  description: 是否复制任务数据
                  default: false
                  example: false
                review_clone_flag:
                  type: boolean
                  description: 是否复制审核配置
                  default: false
                  example: false
              required:
                - name
                - enterprise_id
                - manage_account_id
                - account_id
                - auth_scope
                - enable_mail_collection_status
                - workspace_type
                - demo_status
      responses:
        '200':
          description: 成功创建空间
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          workspace_id:
                            type: string
                            description: 空间ID
                            example: '1234567890'
  /api/app-api/sip/platform/v2/workspace/list:
    get:
      summary: 获取空间列表
      description: 获取当前用户的所有工作空间列表
      operationId: listWorkspaces
      tags:
        - 空间管理
      parameters:
        - name: page
          in: query
          description: 页码
          required: false
          schema:
            type: integer
            default: 1
            example: 1
        - name: page_size
          in: query
          description: 每页数量
          required: false
          schema:
            type: integer
            default: 20
            example: 20
      responses:
        '200':
          description: 成功获取空间列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: 空间总数
                            example: 100
                          page:
                            type: integer
                            description: 当前页码
                            example: 1
                          page_size:
                            type: integer
                            description: 每页数量
                            example: 20
                          workspaces:
                            type: array
                            items:
                              $ref: '#/components/schemas/Workspace'
  /api/app-api/sip/platform/v2/workspace/get:
    get:
      summary: 获取空间详情
      description: 根据空间ID获取空间详细信息
      operationId: getWorkspace
      tags:
        - 空间管理
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
      responses:
        '200':
          description: 成功获取空间详情
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        $ref: '#/components/schemas/Workspace'
  /api/app-api/sip/platform/v2/workspace/update:
    post:
      summary: 更新空间
      description: 更新指定空间的信息
      operationId: updateWorkspace
      tags:
        - 空间管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                name:
                  type: string
                  description: 空间名称
                  example: 我的工作空间
                  maxLength: 50
                description:
                  type: string
                  description: 空间描述
                  example: 这是一个用于处理发票的工作空间
                  maxLength: 200
                auth_scope:
                  type: integer
                  description: 协作范围 0:仅自己可见 1:企业成员可见
                  example: 1
                  enum:
                    - 0
                    - 1
                enable_mail_collection_status:
                  type: boolean
                  description: 启用邮箱收票状态 false:禁用 true:启用
                  example: true
                mail_inbox_address:
                  type: string
                  description: 收件箱地址
                  example: workspace@example.com
                workspace_type:
                  type: integer
                  description: 工作空间类型 0：个人 1：团队
                  example: 1
                  enum:
                    - 0
                    - 1
                callback_url:
                  type: string
                  description: 回调URL
                  example: https://example.com/callback
                callback_retry_time:
                  type: integer
                  description: 回调重试次数
                  example: 3
                  minimum: 0
                  maximum: 3
              required:
                - workspace_id
                - name
                - auth_scope
                - enable_mail_collection_status
                - workspace_type
      responses:
        '200':
          description: 成功更新空间
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/workspace/delete:
    post:
      summary: 删除空间
      description: 删除指定的工作空间
      operationId: deleteWorkspace
      tags:
        - 空间管理
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_ids:
                  type: array
                  items:
                    type: string
                    description: 空间ID
                    example: '1234567890'
                  description: 要删除的空间ID列表
              required:
                - workspace_ids
      responses:
        '200':
          description: 成功删除空间
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/create:
    post:
      summary: 创建文件类别
      description: 在指定空间中创建一个新的文件类别
      operationId: createCategory
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                name:
                  type: string
                  description: 文件类别名称
                  example: 发票
                  maxLength: 50
                category_prompt:
                  type: string
                  description: 用于分类的提示词
                  example: 增值税发票，包含发票代码、发票号码等字段
                  maxLength: 500
                extract_model:
                  description: 抽取模型
                  example: llm
                  enum:
                    - llm
                    - vlm
              required:
                - workspace_id
                - name
                - extract_model
      responses:
        '200':
          description: 成功创建文件类别
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          category_id:
                            type: string
                            description: 文件类别ID
                            example: '1234567890'
  /api/app-api/sip/platform/v2/category/list:
    get:
      summary: 获取空间文件类别列表
      tags:
        - 文件类别
      description: 获取空间文件类别列表
      operationId: listCategories
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: page
          in: query
          description: 页码
          required: false
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          description: 每页数量
          required: false
          schema:
            type: integer
            default: 1000
        - name: enabled
          in: query
          description: |
            启用状态  
            - all: 所有
            - 1: 启用
            - 0: 禁用
            - 2: 草稿
          required: false
          schema:
            type: string
            default: '1'
            enum:
              - all
              - '1'
              - '0'
              - '2'
      responses:
        '200':
          description: 成功获取空间文件类别列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: 文件类别总数
                            example: 100
                          page:
                            type: integer
                            description: 当前页码
                            example: 1
                          page_size:
                            type: integer
                            description: 每页数量
                            example: 20
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'
  /api/app-api/sip/platform/v2/category/update:
    post:
      summary: 更新文件类别
      description: 更新指定文件类别的信息
      operationId: updateCategory
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                name:
                  type: string
                  description: 文件类别名称
                  example: 发票
                  maxLength: 50
                category_prompt:
                  type: string
                  description: 用于分类的提示词
                  example: 增值税发票，包含发票代码、发票号码等字段
                  maxLength: 500
                enabled:
                  $ref: '#/components/schemas/EnabledStatus'
              required:
                - workspace_id
                - category_id
      responses:
        '200':
          description: 成功更新文件类别
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/delete:
    post:
      summary: 删除文件类别
      description: 删除指定的文件类别
      operationId: deleteCategory
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_ids:
                  type: array
                  items:
                    type: string
                  description: 要删除的文件类别ID列表
                  example:
                    - '1234567890'
                    - 0987654321
              required:
                - workspace_id
                - category_ids
      responses:
        '200':
          description: 成功删除文件类别
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/tables/list:
    get:
      summary: 获取文件类别下的表格列表
      description: 获取指定文件类别下配置的所有表格
      operationId: listCategoryTables
      tags:
        - 文件类别
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: category_id
          in: query
          description: 文件类别ID
          required: true
          schema:
            type: string
            example: '1234567890'
      responses:
        '200':
          description: 成功获取文件类别表格列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          tables:
                            type: array
                            description: 表格列表
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                  description: 表格ID
                                  example: '1234567890'
                                name:
                                  type: string
                                  description: 表格名称
                                  example: 表格1
                                prompt:
                                  type: string
                                  description: 表格语义抽取提示词
                                  example: 请抽取每行的品名、数量和金额
                                collect_from_multi_talbe:
                                  type: boolean
                                  description: 多表合并
                                  example: true
  /api/app-api/sip/platform/v2/category/tables/add:
    post:
      summary: 新增文件类别表格
      description: 在指定文件类别下新增一个表格
      operationId: addCategoryTable
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                name:
                  type: string
                  description: 表格名称
                  example: 表格1
                  maxLength: 50
                prompt:
                  type: string
                  description: 表格语义抽取提示词
                  example: 请抽取每行的品名、数量和金额
                  maxLength: 200
                collect_from_multi_talbe:
                  type: boolean
                  description: 多表合并
                  example: true
              required:
                - workspace_id
                - category_id
                - name
      responses:
        '200':
          description: 成功新增文件类别表格
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          table_id:
                            type: string
                            description: 新增表格ID
                            example: '1234567890'
  /api/app-api/sip/platform/v2/category/tables/update:
    post:
      summary: 更新文件类别表格
      description: 更新指定文件类别表格的信息
      operationId: updateCategoryTable
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                table_id:
                  type: string
                  description: 表格ID
                  example: '1234567890'
                name:
                  type: string
                  description: 表格名称
                  example: 表格1
                  maxLength: 50
                prompt:
                  type: string
                  description: 表格语义抽取提示词
                  example: 请抽取每行的品名、数量和金额
                  maxLength: 200
                collect_from_multi_talbe:
                  type: boolean
                  description: 多表合并
                  example: true
              required:
                - workspace_id
                - category_id
                - table_id
                - collect_from_multi_talbe
      responses:
        '200':
          description: 成功更新文件类别表格
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/tables/delete:
    post:
      summary: 删除文件类别表格
      description: 删除指定的文件类别表格，支持批量删除
      operationId: deleteCategoryTables
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                table_ids:
                  type: array
                  description: 要删除的表格ID列表
                  items:
                    type: string
                  example:
                    - '1234567890'
                    - '0987654321'
              required:
                - workspace_id
                - category_id
                - table_ids
      responses:
        '200':
          description: 成功删除文件类别表格
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/fields/list:
    get:
      summary: 获取文件类别字段列表
      description: 获取文件类别字段列表
      operationId: listCategoryFields
      tags:
        - 文件类别
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: category_id
          in: query
          description: 文件类别ID
          required: true
          schema:
            type: string
            example: '1234567890'
      responses:
        '200':
          description: 成功获取文件类别字段列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          fields:
                            type: array
                            items:
                              $ref: '#/components/schemas/CategoryField'
                          tables:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                  description: 表格ID
                                  example: '1234567890'
                                name:
                                  type: string
                                  description: 表格名称
                                  example: 表格1
                                description:
                                  type: string
                                  description: 表格描述
                                  example: 表格描述
                                fields:
                                  type: array
                                  items:
                                    $ref: '#/components/schemas/CategoryField'
  /api/app-api/sip/platform/v2/category/fields/add:
    post:
      summary: 新增文件类别字段
      description: 在指定文件类别下新增一个字段，支持新增普通字段和表格字段
      operationId: addCategoryField
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/CategoryFieldConfig'
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                table_id:
                  type: string
                  description: |
                    表格ID  
                    - 不传或为空：创建普通字段，结果会出现在 result.fields 中  
                    - 传入表格ID：创建对应表格下的表格字段，结果会出现在 result.tables[].fields 中
                  example: '1234567890'
              required:
                - workspace_id
                - category_id
                - name
      responses:
        '200':
          description: 成功新增文件类别字段
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          field_id:
                            type: string
                            description: 新创建的字段ID
                            example: '1234567890'
  /api/app-api/sip/platform/v2/category/fields/update:
    post:
      summary: 更新文件类别字段
      description: 更新指定文件类别字段的信息，支持普通字段和表格字段
      operationId: updateCategoryField
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/CategoryFieldConfig'
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                field_id:
                  type: string
                  description: 字段ID
                  example: '1234567890'
                table_id:
                  type: string
                  description: |
                    表格ID  
                    - 对普通字段可不传  
                    - 对表格字段需要传入其所属的表格ID
                  example: '1234567890'
              required:
                - workspace_id
                - category_id
                - field_id
      responses:
        '200':
          description: 成功更新文件类别字段
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/fields/delete:
    post:
      summary: 删除文件类别字段
      description: 删除指定的文件类别字段，支持批量删除普通字段和表格字段
      operationId: deleteCategoryFields
      tags:
        - 文件类别
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                field_ids:
                  type: array
                  description: 要删除的字段ID列表
                  items:
                    type: string
                  example:
                    - '1234567890'
                    - 0987654321
                table_id:
                  type: string
                  description: |
                    表格ID  
                    - 不传：删除普通字段（result.fields 中的字段）  
                    - 传入表格ID：删除对应表格下的表格字段（result.tables[].fields 中的字段）
                  example: '1234567890'
              required:
                - workspace_id
                - category_id
                - field_ids
      responses:
        '200':
          description: 成功删除文件类别字段
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/category/sample/upload:
    post:
      summary: 上传类别样本
      description: 为指定文件类别上传样本文件
      operationId: uploadCategorySample
      tags:
        - 文件类别样本
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                file:
                  type: string
                  format: binary
                  description: 样本文件
              required:
                - workspace_id
                - category_id
                - file
      responses:
        '200':
          description: 成功上传类别样本
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          sample_id:
                            type: string
                            description: 样本ID
                            example: '1234567890'
  /api/app-api/sip/platform/v2/category/sample/list:
    get:
      summary: 获取类别样本列表
      description: 获取指定文件类别的样本列表
      operationId: listCategorySamples
      tags:
        - 文件类别样本
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: category_id
          in: query
          description: 文件类别ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: page
          in: query
          description: 页码
          required: false
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          description: 每页数量
          required: false
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: 成功获取类别样本列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          total:
                            type: integer
                            description: 样本总数
                            example: 10
                          page:
                            type: integer
                            description: 当前页码
                            example: 1
                          page_size:
                            type: integer
                            description: 每页数量
                            example: 20
                          samples:
                            type: array
                            items:
                              $ref: '#/components/schemas/CategorySample'
  /api/app-api/sip/platform/v2/category/sample/download:
    get:
      summary: 下载类别样本
      description: 下载指定的类别样本文件
      operationId: downloadCategorySample
      tags:
        - 文件类别样本
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: category_id
          in: query
          description: 文件类别ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: sample_id
          in: query
          description: 样本ID
          required: true
          schema:
            type: string
            example: '1234567890'
      responses:
        '200':
          description: 成功下载样本文件
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
  /api/app-api/sip/platform/v2/category/sample/delete:
    post:
      summary: 删除类别样本
      description: 删除指定的类别样本
      operationId: deleteCategorySample
      tags:
        - 文件类别样本
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                category_id:
                  type: string
                  description: 文件类别ID
                  example: '1234567890'
                sample_ids:
                  type: array
                  items:
                    type: string
                  description: 要删除的样本ID列表
                  example:
                    - '1234567890'
                    - 0987654321
              required:
                - workspace_id
                - category_id
                - sample_ids
      responses:
        '200':
          description: 成功删除类别样本
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule_repo/create:
    post:
      summary: 创建审核规则库
      description: 创建审核规则库
      operationId: createReviewRuleRepo
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                name:
                  type: string
                  description: 库名称
                  example: 审核规则库1
                  maxLength: 30
              required:
                - workspace_id
                - name
      responses:
        '200':
          description: 成功创建审核规则库
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          repo_id:
                            type: integer
                            description: 审核规则库ID
                            example: '31415926'
  /api/app-api/sip/platform/v2/review/rule_repo/delete:
    post:
      summary: 删除审核规则库
      description: 删除审核规则库
      operationId: deleteReviewRuleRepo
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                repo_ids:
                  type: array
                  items:
                    type: integer
                    description: 审核规则库ID
                    example: '31415926'
              required:
                - workspace_id
                - repo_ids
      responses:
        '200':
          description: 成功删除审核规则库
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule_repo/update:
    post:
      summary: 更新审核规则库
      description: 更新审核规则库
      operationId: updateReviewRuleRepo
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                repo_id:
                  type: integer
                  description: 审核规则库ID
                  example: '31415926'
                name:
                  type: string
                  description: 库名称
                  example: 审核规则库1
                  maxLength: 30
              required:
                - workspace_id
                - repo_id
      responses:
        '200':
          description: 成功更新审核规则库
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule_repo/list:
    get:
      summary: 获取审核规则库列表
      description: '获取审核规则库列表, 包含规则库下的规则组和规则信息'
      operationId: listReviewRuleRepo
      tags:
        - 智能审核
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: page
          in: query
          description: 页码
          required: false
          schema:
            type: integer
            example: 1
            default: 1
        - name: page_size
          in: query
          description: 每页条数
          required: false
          schema:
            type: integer
            example: 10
            default: 10
      responses:
        '200':
          description: 成功获取审核规则库列表
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          repos:
                            type: array
                            items:
                              $ref: '#/components/schemas/ReviewRuleRepo'
                          total:
                            type: integer
                            description: 总条数
                            example: 100
                          page:
                            type: integer
                            description: 页码
                            example: 1
                          page_size:
                            type: integer
                            description: 每页条数
                            example: 10
  /api/app-api/sip/platform/v2/review/rule_repo/get:
    get:
      summary: 获取审核规则库
      description: 获取审核规则库
      operationId: getReviewRuleRepo
      tags:
        - 智能审核
      parameters:
        - name: workspace_id
          in: query
          description: 空间ID
          required: true
          schema:
            type: string
            example: '1234567890'
        - name: repo_id
          in: query
          description: 审核规则库ID
          required: true
          schema:
            type: string
            example: '31415926'
      responses:
        '200':
          description: 成功获取审核规则库
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        $ref: '#/components/schemas/ReviewRuleRepo'
  /api/app-api/sip/platform/v2/review/rule_group/create:
    post:
      summary: 创建审核规则组
      description: 创建审核规则组
      operationId: createReviewRuleGroup
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                repo_id:
                  type: integer
                  description: 审核规则库ID
                  example: '31415926'
                name:
                  type: string
                  description: 组名称
                  example: 审核规则组1
                  maxLength: 30
              required:
                - workspace_id
                - repo_id
                - name
      responses:
        '200':
          description: 成功创建审核规则组
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          group_id:
                            type: string
                            description: 审核规则组ID
                            example: '31415926'
  /api/app-api/sip/platform/v2/review/rule_group/delete:
    post:
      summary: 删除审核规则组
      description: 删除审核规则组
      operationId: deleteReviewRuleGroup
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                group_id:
                  type: string
                  description: 审核规则组ID
                  example: '31415926'
              required:
                - workspace_id
                - group_id
      responses:
        '200':
          description: 成功删除审核规则组
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule_group/update:
    post:
      summary: 更新审核规则组
      description: 更新审核规则组
      operationId: updateReviewRuleGroup
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                group_id:
                  type: string
                  description: 审核规则组ID
                  example: '31415926'
                name:
                  type: string
                  description: 组名称
                  example: 审核规则组1
                  maxLength: 30
              required:
                - workspace_id
                - group_id
      responses:
        '200':
          description: 成功更新审核规则组
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule/create:
    post:
      summary: 创建审核规则
      description: 创建审核规则
      operationId: createReviewRule
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/ReviewRuleProperties'
                - type: object
                  properties:
                    workspace_id:
                      type: string
                      description: 空间ID
                      example: '1234567890'
                    repo_id:
                      type: integer
                      description: 审核规则库ID
                      example: '31415926'
                  required:
                    - workspace_id
                    - repo_id
      responses:
        '200':
          description: 成功创建审核规则
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          rule_id:
                            type: string
                            description: 审核规则ID
                            example: '31415926'
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule/update:
    post:
      summary: 更新审核规则
      description: 更新审核规则
      operationId: updateReviewRule
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - type: object
                  properties:
                    workspace_id:
                      type: string
                      description: 空间ID
                      example: '1234567890'
                    rule_id:
                      type: string
                      description: 审核规则ID
                      example: '31415926'
                - $ref: '#/components/schemas/ReviewRuleProperties'
      responses:
        '200':
          description: 成功更新审核规则
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/rule/delete:
    post:
      summary: 删除审核规则
      description: 删除审核规则
      operationId: deleteReviewRule
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                rule_id:
                  type: string
                  description: 审核规则ID
                  example: '31415926'
              required:
                - workspace_id
                - rule_id
      responses:
        '200':
          description: 成功删除审核规则
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/task/submit:
    post:
      summary: 新建审核任务
      description: 新建审核任务
      operationId: submitReviewTask
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                name:
                  type: string
                  description: 任务名称
                  example: 审核任务1
                  maxLength: 100
                repo_id:
                  type: string
                  description: 审核规则库ID
                  example: '31415926'
                extract_task_ids:
                  type: array
                  items:
                    type: string
                    description: 抽取任务ID
                    example: '1234567890'
                batch_number:
                  type: string
                  description: 批次号
                  example: '1234567890'
              required:
                - workspace_id
                - name
                - repo_id
      responses:
        '200':
          description: 成功新建审核任务
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          task_id:
                            type: string
                            description: 审核任务ID
                            example: '31415926'
  /api/app-api/sip/platform/v2/review/task/delete:
    post:
      summary: 删除审核任务
      description: 删除审核任务
      operationId: deleteReviewTask
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                task_ids:
                  type: array
                  items:
                    type: string
                    description: 审核任务ID
                    example: '31415926'
              required:
                - workspace_id
                - task_ids
      responses:
        '200':
          description: 成功删除审核任务
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/task/result:
    post:
      summary: 获取审核结果
      description: 获取审核结果
      operationId: getReviewTaskResult
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                task_id:
                  type: string
                  description: 审核任务ID
                  example: '31415926'
                with_task_detail_url:
                  type: boolean
                  description: 是否返回审核详情页URL
                  example: false
              required:
                - workspace_id
                - task_id
      responses:
        '200':
          description: 成功获取审核任务结果
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
                  - type: object
                    properties:
                      result:
                        type: object
                        properties:
                          task_id:
                            type: string
                            description: 审核任务ID
                            example: '31415926'
                          task_name:
                            type: string
                            description: 任务名称
                            example: 审核任务1
                          task_detail_url:
                            type: string
                            description: 审核任务详情URL
                          status:
                            $ref: '#/components/schemas/ReviewTaskStatus'
                          rule_repo:
                            type: object
                            properties:
                              repo_id:
                                type: string
                                description: 审核规则库ID
                                example: '31415926'
                              name:
                                type: string
                                description: 审核规则库名称
                                example: 审核规则库1
                          extract_task_ids:
                            type: array
                            items:
                              type: string
                              description: 抽取任务ID
                              example: '1234567890'
                          statistics:
                            type: object
                            properties:
                              pass_count:
                                type: integer
                                description: 通过数
                                example: 100
                              failure_count:
                                type: integer
                                description: 不通过数
                                example: 100
                              error_count:
                                type: integer
                                description: 任务执行异常数
                                example: 100
                          groups:
                            type: array
                            items:
                              type: object
                              properties:
                                group_id:
                                  type: string
                                  description: 审核规则组ID
                                  example: '31415926'
                                group_name:
                                  type: string
                                  description: 审核规则组名称
                                  example: 审核规则组1
                                review_tasks:
                                  type: array
                                  items:
                                    type: object
                                    properties:
                                      rule_task_id:
                                        type: string
                                        description: 审核子任务ID
                                        example: '31415926'
                                      rule_id:
                                        type: string
                                        description: 审核规则ID
                                        example: '31415926'
                                      rule_name:
                                        type: string
                                        description: 审核规则名称
                                        example: 审核规则1
                                      risk_level:
                                        $ref: '#/components/schemas/RiskLevel'
                                      prompt:
                                        type: string
                                        description: 审核规则提示词
                                        example: 审核规则提示词
                                      review_result:
                                        $ref: '#/components/schemas/ReviewTaskStatus'
                                      reasoning:
                                        type: string
                                        description: 审核依据
                                        example: 审核依据
                                      anchors:
                                        type: array
                                        description: 审核依据的位置回溯信息，用于定位审核依据在原文中的位置
                                        items:
                                          type: object
                                          properties:
                                            start_pos:
                                              type: integer
                                              description: 在`reasoning`中的起始字符位置
                                            end_pos:
                                              type: integer
                                              description: 在`reasoning`中的结束字符位置
                                            text:
                                              type: string
                                              description: 原文内容
                                            vertices:
                                              type: array
                                              items:
                                                type: integer
                                                description: 原文内容的外接四边形坐标
                                                example:
                                                  - 0
                                                  - 0
                                                  - 100
                                                  - 0
                                                  - 100
                                                  - 100
                                                  - 0
                                                  - 100
                                            file_id:
                                              type: string
                                              description: 文件ID
                                              example: '1234567890'
                                            extract_task_id:
                                              type: string
                                              description: 抽取任务ID
                                              example: '1234567890'
                                            page:
                                              type: integer
                                              description: 所在文件中的页码
                                              example: 1
                                            source:
                                              type: string
                                              description: |
                                                位置回溯来源
                                                - "ocr": 识别
                                                - "extract_field": 关联字段
                                              example: ocr
                                              enum:
                                                - ocr
                                                - extract_field
                                            file_category:
                                              type: string
                                              description: 文件类别
                                              example: 发票
                                            field_name:
                                              type: string
                                              description: 关联字段名称
                                              example: 发票代码
                                      audit_result:
                                        type: integer
                                        description: |
                                          人工复核结果
                                          - 0: 人工复核不通过
                                          - 1: 人工复核通过
                                        example: 1
                                        enum:
                                          - 0
                                          - 1
                                      audit_message:
                                        type: string
                                        description: 人工复核批注
                                        example: 人工复核批注
  /api/app-api/sip/platform/v2/review/task/retry:
    post:
      summary: 重新审核任务
      description: 重新审核任务
      operationId: retryReviewTask
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                task_id:
                  type: string
                  description: 审核任务ID
                  example: '31415926'
              required:
                - workspace_id
                - task_id
      responses:
        '200':
          description: 成功重新审核任务
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
  /api/app-api/sip/platform/v2/review/task/rule/retry:
    post:
      summary: 重新审核任务中的某条规则
      description: 重新审核任务中的某条规则。
      operationId: retryReviewTaskRule
      tags:
        - 智能审核
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                workspace_id:
                  type: string
                  description: 空间ID
                  example: '1234567890'
                task_id:
                  type: string
                  description: 审核任务ID
                  example: '31415926'
                rule_id:
                  type: string
                  description: 审核规则ID
                  example: '31415926'
              required:
                - workspace_id
                - task_id
                - rule_id
      responses:
        '200':
          description: 成功重新审核任务中的某条规则
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CodeMessage'
components:
  parameters:
    WorkspaceId:
      name: workspace_id
      in: query
      description: 空间ID
      required: true
      schema:
        type: string
        example: 1234567890
    Category:
      name: category
      in: query
      description: 文件类别
      required: false
      schema:
        type: string
        example: invoice
    BatchNumber:
      name: batch_number
      in: query
      description: |
        批次编号。  
        可以用同一个批次编号上传多次，后续可以用批次编号获取该批次多个文件处理结果。  
        如果值为空，则系统自动生成最长20位字符串
      required: false
      schema:
        type: string
        example: 202412190001
    AutoVerifyVat:
      name: auto_verify_vat
      in: query
      description: 是否自动进行发票验真
      required: false
      schema:
        type: boolean
        default: false
    SplitFlag:
      name: split_flag
      in: query
      description: 是否进行文件拆分
      required: false
      schema:
        type: boolean
        default: false
    CropFlag:
      name: crop_flag
      in: query
      description: 是否进行多图切分
      required: false
      schema:
        type: boolean
        default: false
    TargetProcess:
      name: target_process
      in: query
      description: |
        目标处理类型。  
        可选值：  
        - `classify`: 分类  
        - `extract`: 抽取  
      required: false
      schema:
        type: string
        enum:
          - classify
          - extract
        example: classify
    ParserRemoveWatermark:
      name: parser_remove_watermark
      in: query
      description: '是否去水印（0:不去水印、1:去水印）'
      required: false
      schema:
        type: integer
        default: 0
    ParserCropDewarp:
      name: parser_crop_dewarp
      in: query
      description: '是否进行切边矫正（0:不进行切边矫正、1:进行切边矫正）'
      required: false
      schema:
        type: integer
        default: 0
    ParserApplyMerge:
      name: parser_apply_merge
      in: query
      description: '是否进行跨页段落表格合并（0:不合并、1:合并）'
      required: false
      schema:
        type: integer
        default: 1
    ParserFormulaLevel:
      name: parser_formula_level
      in: query
      description: 公式识别等级(0 行间公式和行内公式都识别、1 仅识别行间公式，行内公式不识别、2 不识别公式)
      required: false
      schema:
        type: integer
        default: 0
    ParserTableTextSplitMode:
      name: parser_table_text_split_mode
      in: query
      description: '表格线是否分割ocr文本（0:不切割、1:切割）'
      required: false
      schema:
        type: integer
        default: 0
    WithTaskDetailUrl:
      name: with_task_detail_url
      in: query
      description: 是否返回任务详情页URL
      required: false
      schema:
        type: boolean
        default: false
  requestBodies:
    FileUploadRequestBody:
      description: 文件上传请求体
      required: true
      content:
        multipart/form-data:
          schema:
            type: object
            properties:
              file:
                type: string
                format: binary
        application/json:
          schema:
            type: object
            properties:
              urls:
                description: |
                  文件URL列表
                  一次最多支持上传10个文件URL，每个文件最大不超过50MB
                type: array
                items:
                  type: string
                  description: 文件URL
                  example: 'https://example.com/file.pdf'
                  pattern: '^https?://.*$'
                maxItems: 10
            required:
              - urls
  securitySchemes:
    ApiId:
      type: apiKey
      in: header
      name: x-ti-app-id
    SecretCode:
      type: apiKey
      in: header
      name: x-ti-secret-code
  schemas:
    CodeMessage:
      type: object
      properties:
        code:
          type: integer
          description: 状态码
          example: 200
        msg:
          type: string
          description: 状态描述
      required:
        - code
        - msg
    TaskType:
      type: integer
      description: >
        任务类型

        - `0`:
        **文件拆分子任务**：打开"文件拆分"开关的文件任务执行成功后，该文件批次任务中因文件拆分操作产生的子任务即为拆分子任务，按照文件类别下实际文件套数区分子任务

        - `1`: **普通任务**：未打开"文件拆分"和"多图切分"开关的文件任务

        - `2`: **父任务**：打开"文件拆分"或"多图切分"开关的文件任务执行后，该文件批次任务中的每份文件即为父任务

        - `3`:
        **切图子任务**：打开"多图切分"开关的文件任务执行成功后，该文件批次任务中因多图切分操作产生的子任务即为切分子任务，按照文件类别下实际切图结果数量区分子任务
      example: 1
    RecognitionStatus:
      type: integer
      description: |
        文件识别状态: 
        - 0: 待识别
        - 1: 识别成功
        - 2: 识别失败
        - 3: 分类中
        - 4: 抽取中
        - 5: 准备中
        - 6: 文件拆分中
        - 7: 切图中
        - 10: 分类完成(当upload接口的target_process为classify时才有此状态)
        - 20: 解析中
      enum:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
        - 10
        - 20
    VerificationStatus:
      type: integer
      description: '文件核对状态 0: 待核对 2: 已确认 3: 已拒绝 4: 已删除 5: 推迟处理'
      enum:
        - 0
        - 2
        - 3
        - 4
        - 5
    PagesInfo:
      type: array
      description: |
        文件每页用于渲染的数据。  
        配合`data.fields`中的`page`和`position`字段，可以准确画出字段在页面上的位置。
      items:
        type: object
        properties:
          page:
            type: integer
            description: '页码,从0开始'
            example: 1
          angle:
            type: integer
            description: 旋转角度
            enum:
              - 0
              - 90
              - 180
              - 270
          width:
            type: integer
            description: 转正后的页宽
            example: 1024
          height:
            type: integer
            description: 转正后的页高
            example: 1024
          dpi:
            type: integer
            description: PDF转图片时的分辨率。非PDF文件该值为`0`.
            example: 144
    KeyValuePosition:
      description: 字段值的位置。字段值可能跨页或跨行，因此用数组展示。
      type: array
      items:
        type: object
        properties:
          page:
            type: integer
            description: 字段所在页。是`pages`数组的索引
          vertices:
            type: array
            description: >-
              字段值的外接四边形坐标。图像以左上为原点，数组值为 [左上角x, 左上角y, 右上角x, 右上角y, 右下角x, 右下角y,
              左下角x, 左下角y]
            items:
              type: integer
            minItems: 8
            maxItems: 8
    FieldRespKeyValue:
      type: object
      properties:
        key:
          type: string
          description: 字段名
        identifier:
          type: string
          description: 导出字段名
        value:
          type: string
          description: 字段值
        position:
          $ref: '#/components/schemas/KeyValuePosition'
    KeyValue:
      type: object
      properties:
        key:
          type: string
          description: 字段名
        value:
          type: string
          description: 字段值
        position:
          $ref: '#/components/schemas/KeyValuePosition'
    TextInLines:
      type: object
      properties:
        angle:
          type: string
          description: 角度
          example: 0
        pos:
          type: array
          description: 坐标
          items:
            type: integer
            description: 坐标
            example: 1
        page:
          type: integer
          description: 页码
          example: 1
        text:
          type: string
          description: 文本
          example: 文本内容
        char_pos:
          type: array
          description: 字符坐标
          items:
            type: array
            description: 字符坐标
            items:
              type: integer
              description: 字符坐标
              example: 1
      description: 字段坐标
    CommonFieldDetailRespVO:
      type: object
      properties:
        key:
          type: string
          description: 字段key
        identifier:
          type: string
          description: 导出字段名
        value:
          type: string
          description: 字段值
        textInLines:
          deprecated: true
          type: array
          description: |
            **已废弃**，请使用position字段替代
            字段坐标
          items:
            $ref: '#/components/schemas/TextInLines'
        position:
          $ref: '#/components/schemas/KeyValuePosition'
        index:
          type: integer
          description: 索引
    StampValue:
      type: object
      properties:
        angel:
          type: integer
          description: 角度
        page:
          type: integer
          description: 页码
        text:
          type: string
          description: 印章文本内容
        type:
          type: string
          description: 印章类型
        color:
          type: string
          description: 印章颜色
        shape:
          type: string
          description: 印章形状
        position:
          type: array
          description: 位置信息
          items:
            type: integer
          example: 1
    HandWritingValue:
      type: object
      properties:
        angel:
          type: integer
          description: 角度
        page:
          type: integer
          description: 页码
        text:
          type: string
          description: 印章文本内容
        position:
          $ref: '#/components/schemas/KeyValuePosition'
    Document:
      type: object
      properties:
        pages:
          type: array
          items:
            type: object
            properties:
              angle:
                type: integer
                description: 页面的旋转角度
              width:
                type: integer
                description: 页面的宽度
              height:
                type: integer
                description: 页面的高度
              lines:
                description: 页面的文本行数组
                type: array
                items:
                  type: object
                  properties:
                    text:
                      type: string
                      description: 行文本
                    position:
                      type: array
                      items:
                        type: integer
                      minItems: 8
                      maxItems: 8
                    charPositions:
                      type: array
                      items:
                        type: array
                        items:
                          type: integer
                        minItems: 8
                        maxItems: 8
    TaskCropResult:
      type: object
      properties:
        page:
          type: integer
          description: 所属原文件的页索引，0代表源文件的第一页
        imageAngle:
          type: string
          description: 切分图片的角度信息
    SubFileDetailInfo:
      type: object
      properties:
        id:
          type: string
          description: 文件ID
          example: 202412190001
        task_id:
          type: string
          description: 任务ID
          example: 202412190001
        task_detail_url:
          type: string
          description: 文件子任务详情页URL
        task_type:
          $ref: '#/components/schemas/TaskType'
        parent_task_id:
          type: string
          description: 父任务ID（不为0时有意义）
          example: 202412190001
        batch_number:
          type: string
          description: 批次编号
          example: 202412190001
        name:
          type: string
          description: 文件名
          example: invoice.pdf
        format:
          type: string
          description: 文件格式
        recognition_status:
          $ref: '#/components/schemas/RecognitionStatus'
        verification_status:
          $ref: '#/components/schemas/VerificationStatus'
        category:
          type: string
          description: 文件类别
          example: invoice
        pages:
          $ref: '#/components/schemas/PagesInfo'
        data:
          type: object
          description: 处理结果
          properties:
            fields:
              description: 字段列表
              type: array
              items:
                $ref: '#/components/schemas/FieldRespKeyValue'
              example:
                - key: 发票代码
                  identifier: 发票代码标识
                  value: '3100231130'
                  position:
                    - page: 0
                      vertices:
                        - 0
                        - 0
                        - 100
                        - 0
                        - 100
                        - 100
                        - 0
                        - 100
                - key: 发票号码
                  identifier: 发票号码标识
                  value: '28737000'
                  position:
                    - page: 0
                      vertices:
                        - 0
                        - 0
                        - 100
                        - 0
                        - 100
                        - 100
                        - 0
                        - 100
            items:
              description: 表格数据列表
              type: array
              items:
                type: array
                items:
                  $ref: '#/components/schemas/KeyValue'
              example:
                - - key: 货物劳务名称
                    value: ＊电子计算机＊微型计算机主机
                    position:
                      - page: 0
                        vertices:
                          - 0
                          - 0
                          - 100
                          - 0
                          - 100
                          - 100
                          - 0
                          - 100
                  - key: 规格型号
                    value: DMS-SC68
                    position:
                      - page: 0
                        vertices:
                          - 0
                          - 0
                          - 100
                          - 0
                          - 100
                          - 100
                          - 0
                          - 100
                - - key: 货物劳务名称
                    value: ＊机械计算机＊巨型计算机主机
                    position:
                      - page: 0
                        vertices:
                          - 0
                          - 0
                          - 100
                          - 0
                          - 100
                          - 100
                          - 0
                          - 100
                  - key: 规格型号
                    value: AN/FSQ-7
                    position:
                      - page: 0
                        vertices:
                          - 0
                          - 0
                          - 100
                          - 0
                          - 100
                          - 100
                          - 0
                          - 100
            tables:
              description: 全部表格数据列表（含系统表格和手动配置表格）
              type: array
              items:
                type: object
                properties:
                  tableName:
                    description: 表格名称
                    type: string
                    example: table1
                  tableType:
                    description: 表格类型， 0， 系统配置， 1 手动添加。
                    type: string
                    example: 0
                  items:
                    type: array
                    items:
                      type: array
                      items:
                        $ref: '#/components/schemas/CommonFieldDetailRespVO'
            stamps:
              description: 印章信息
              type: array
              items:
                $ref: '#/components/schemas/StampValue'
              example:
                - angel: 0
                  page: 0
                  text: 全国统一发票监制章
                  type: 其他
                  color: 红色
                  shape: 椭圆章
                  position:
                    - 0
                    - 0
                    - 100
                    - 0
                    - 100
                    - 100
                    - 0
                    - 100
                - angel: 0
                  page: 0
                  text: 税务局章
                  type: 其他
                  color: 红色
                  shape: 椭圆章
                  position:
                    - 0
                    - 0
                    - 100
                    - 0
                    - 100
                    - 100
                    - 0
                    - 100
            handwritings:
              description: 手写体信息
              type: array
              items:
                $ref: '#/components/schemas/HandWritingValue'
              example:
                - angel: 0
                  page: 0
                  text: 3月1日
                  position:
                    - page: 0
                      vertices:
                        - 0
                        - 0
                        - 100
                        - 0
                        - 100
                        - 100
                        - 0
                        - 100
                - angel: 0
                  page: 0
                  text: 张三
                  position:
                    - page: 0
                      vertices:
                        - 0
                        - 0
                        - 100
                        - 0
                        - 100
                        - 100
                        - 0
                        - 100
            invoiceVerifyResult:
              description: 发票验真结果
              type: object
              properties:
                invoiceVerifyStatus:
                  type: integer
                  description: '发票验真是否成功(0:否,1:是, null:未验真)'
                  example: 0
                invoiceVerifyErrorCode:
                  type: integer
                  description: 发票验真错误码
                  example: 0
                invoiceVerifyCanRetry:
                  type: integer
                  description: '发票验真是否可以重试/发起(0:否,1:是)'
                  example: 0
                invoiceVerifyFailMsg:
                  type: string
                  description: 发票验真失败原因
                  example: 超过当天次数上限
        document:
          $ref: '#/components/schemas/Document'
        from_parent_position_list:
          type: array
          description: 切图结果在原文件中的坐标位置
          items:
            type: integer
            description: 位置信息
            example: 1
        crop_info:
          $ref: '#/components/schemas/TaskCropResult'
    TaskProcessResult:
      type: object
      properties:
        result:
          type: object
          properties:
            total:
              type: integer
              description: 文件总数
              example: 100
            page:
              type: integer
              description: 当前页码
              example: 1
            page_size:
              type: integer
              description: 每页数量
              example: 20
            files:
              type: array
              items:
                type: object
                properties:
                  id:
                    type: string
                    description: 文件ID
                    example: 202412190001
                  task_id:
                    type: string
                    description: 任务ID
                    example: 202412190001
                  task_detail_url:
                    type: string
                    description: 文件任务详情页URL
                  task_type:
                    $ref: '#/components/schemas/TaskType'
                  batch_number:
                    type: string
                    description: 批次编号
                    example: 202412190001
                  name:
                    type: string
                    description: 文件名
                    example: invoice.pdf
                  format:
                    type: string
                    description: 文件格式
                  recognition_status:
                    $ref: '#/components/schemas/RecognitionStatus'
                  failure_causes:
                    type: string
                    description: |
                      任务失败原因。  
                      当recognition_status为2时，有此字段。
                  verification_status:
                    $ref: '#/components/schemas/VerificationStatus'
                  category:
                    type: string
                    description: 文件类别
                    example: invoice
                  pages:
                    $ref: '#/components/schemas/PagesInfo'
                  data:
                    type: object
                    description: 处理结果
                    properties:
                      fields:
                        description: 字段列表
                        type: array
                        items:
                          $ref: '#/components/schemas/FieldRespKeyValue'
                        example:
                          - key: 发票代码
                            identifier: 发票代码标识
                            value: '3100231130'
                            position:
                              - page: 0
                                vertices:
                                  - 0
                                  - 0
                                  - 100
                                  - 0
                                  - 100
                                  - 100
                                  - 0
                                  - 100
                          - key: 发票号码
                            value: '28737000'
                            identifier: 发票号码标识
                            position:
                              - page: 0
                                vertices:
                                  - 0
                                  - 0
                                  - 100
                                  - 0
                                  - 100
                                  - 100
                                  - 0
                                  - 100
                      items:
                        description: 表格数据列表
                        type: array
                        items:
                          type: array
                          items:
                            $ref: '#/components/schemas/KeyValue'
                        example:
                          - - key: 货物劳务名称
                              value: ＊电子计算机＊微型计算机主机
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                            - key: 规格型号
                              value: DMS-SC68
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                          - - key: 货物劳务名称
                              value: ＊机械计算机＊巨型计算机主机
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                            - key: 规格型号
                              value: AN/FSQ-7
                              position:
                                - page: 0
                                  vertices:
                                    - 0
                                    - 0
                                    - 100
                                    - 0
                                    - 100
                                    - 100
                                    - 0
                                    - 100
                      tables:
                        description: 全部表格数据列表（含系统表格和手动配置表格）
                        type: array
                        items:
                          type: object
                          properties:
                            tableName:
                              description: 表格名称
                              type: string
                              example: table1
                            tableType:
                              description: 表格类型， 0， 系统配置， 1 手动添加。
                              type: string
                              example: 0
                            items:
                              type: array
                              items:
                                type: array
                                items:
                                  $ref: '#/components/schemas/CommonFieldDetailRespVO'
                      stamps:
                        description: 印章信息
                        type: array
                        items:
                          $ref: '#/components/schemas/StampValue'
                        example:
                          - angel: 0
                            page: 0
                            text: 全国统一发票监制章
                            type: 其他
                            color: 红色
                            shape: 椭圆章
                            position:
                              - 0
                              - 0
                              - 100
                              - 0
                              - 100
                              - 100
                              - 0
                              - 100
                          - angel: 0
                            page: 0
                            text: 税务局章
                            type: 其他
                            color: 红色
                            shape: 椭圆章
                            position:
                              - 0
                              - 0
                              - 100
                              - 0
                              - 100
                              - 100
                              - 0
                              - 100
                      handwritings:
                        description: 手写体信息
                        type: array
                        items:
                          $ref: '#/components/schemas/HandWritingValue'
                        example:
                          - angel: 0
                            page: 0
                            text: 3月1日
                            position:
                              - page: 0
                                vertices:
                                  - 0
                                  - 0
                                  - 100
                                  - 0
                                  - 100
                                  - 100
                                  - 0
                                  - 100
                          - angel: 0
                            page: 0
                            text: 张三
                            position:
                              - page: 0
                                vertices:
                                  - 0
                                  - 0
                                  - 100
                                  - 0
                                  - 100
                                  - 100
                                  - 0
                                  - 100
                      invoiceVerifyResult:
                        description: 发票验真结果
                        type: object
                        properties:
                          invoiceVerifyStatus:
                            type: integer
                            description: '发票验真是否成功(0:否,1:是, null:未验真)'
                            example: 0
                          invoiceVerifyErrorCode:
                            type: integer
                            description: 发票验真错误码
                            example: 0
                          invoiceVerifyCanRetry:
                            type: integer
                            description: '发票验真是否可以重试/发起(0:否,1:是)'
                            example: 0
                          invoiceVerifyFailMsg:
                            type: string
                            description: 发票验真失败原因
                            example: 超过当天次数上限
                  document:
                    $ref: '#/components/schemas/Document'
                  child_files:
                    description: 子任务信息
                    type: array
                    items:
                      $ref: '#/components/schemas/SubFileDetailInfo'
                  duration_ms:
                    type: integer
                    description: |
                      任务处理时间，单位：毫秒
                      计算的是从任务开始至完成(成功或失败)的时间，不包括排队等待时间。
                    example: 10000
                  total_page_num:
                    type: integer
                    description: 当前文件总页数
                    example: 10
                required:
                  - id
                  - name
                  - format
                  - recognition_status
                  - verification_status
                  - category
    ExtractFieldReqVO:
      type: object
      properties:
        key:
          type: string
          description: 字段名称
          example: 发票代码
        prompt:
          type: string
          description: 字段提示
          example: 只保留年的部分
    DocumentParserParam:
      type: object
      properties:
        formula_level:
          type: integer
          description: 公式识别等级(0 行间公式和行内公式都识别、1 仅识别行间公式，行内公式不识别、2 不识别公式)
          example: 0
        apply_merge:
          type: integer
          description: 跨页段落表格合并(0 不合并、1 合并)
          example: 1
        table_text_split_mode:
          type: integer
          description: 切分被表格线穿过的文本块(0 不切分、1 切分)
          example: 0
        crop_dewarp:
          type: integer
          description: 是否进行切边矫正(0 不进行切边矫正、1 进行切边矫正)
          example: 0
        remove_watermark:
          type: integer
          description: 是否去水印(0 不去水印、1 去水印)
          example: 0
    TokenResult:
      type: object
      properties:
        result:
          type: object
          properties:
            token:
              type: string
              description: 有效的token
              example: abcd
            expiry:
              type: integer
              description: 过期时间(格式是epoch时间戳，单位：秒)
              example: 1700000000
    Workspace:
      type: object
      description: 工作空间
      properties:
        workspace_id:
          type: string
          description: 空间ID（系统生成）
          example: '1234567890'
        name:
          type: string
          description: 空间名称
          example: 我的工作空间
        description:
          type: string
          description: 空间描述
          example: 这是一个用于处理发票的工作空间
        enable_mail_collection_status:
          type: integer
          description: 启用邮箱收票状态 0:禁用 1:启用
          example: 2
          enum:
            - 0
            - 1
        mail_inbox_address:
          type: string
          description: 收件箱地址
          example: workspace@example.com
        init_classification_status:
          type: integer
          description: 初始化类型操作状态 0：未初始化 1：初始化中 2：初始化成功 3：初始化失败
          example: 2
          enum:
            - 0
            - 1
            - 2
            - 3
        workspace_type:
          type: integer
          description: 工作空间类型 0：个人 1：团队
          example: 1
          enum:
            - 0
            - 1
        demo_status:
          type: integer
          description: 是否为demo工作空间 0：否 1：是
          example: 1
          enum:
            - 0
            - 1
        auth_scope:
          type: integer
          description: 协作范围 0:仅自己可见 1:企业成员可见
          example: 1
          enum:
            - 0
            - 1
        manage_account_id:
          type: string
          description: 空间管理员id
          example: admin_123456
        manage_account_name:
          type: string
          description: 空间管理员名称
          example: 张三
        doc_count:
          type: integer
          description: 文档数量
          example: 150
        classification_count:
          type: integer
          description: 类别数量
          example: 8
        review_rule_repo_count:
          type: integer
          description: 规则库数量
          example: 5
        callback_url:
          type: string
          description: 回调URL
          example: https://example.com/callback
        callback_retry_time:
          type: integer
          description: 回调重试次数
          example: 3
      required:
        - workspace_id
        - name
    EnabledStatus:
      type: integer
      description: |
        启用状态
        - 0: 禁用
        - 1: 启用
        - 2: 草稿
      enum:
        - 0
        - 1
        - 2
    Category:
      type: object
      description: 文件类别
      properties:
        id:
          type: string
          description: 文件类别ID
          example: '1234567890'
        name:
          type: string
          description: 文件类别名称
          example: 发票
        category_prompt:
          type: string
          description: 用于分类的提示词
          example: 增值税发票，包含发票代码、发票号码等字段
        extract_model:
          description: 抽取模型
          example: llm
          enum:
            - llm
            - vlm
        enabled:
          $ref: '#/components/schemas/EnabledStatus'
      required:
        - id
        - name
    CategoryFieldConfig:
      type: object
      properties:
        name:
          type: string
          description: 字段名称
          example: 发票代码
        description:
          type: string
          description: 字段描述
          example: 发票代码描述
        prompt:
          type: string
          description: 语义抽取提示词
        use_prompt:
          type: boolean
          description: 是否使用语义提示词
        alias:
          type: array
          description: 字段别名
          items:
            type: string
        identity:
          type: string
          description: 导出字段名
        multi_value:
          type: boolean
          description: 是否多值抽取
        transform_settings:
          type: object
          description: 转换配置
          properties:
            type:
              type: string
              description: 转换类型
              enum:
                - text
                - number
                - datetime
                - enumerate
                - regex
            text_settings:
              type: object
              description: 文本类型转换配置
              properties:
                strip:
                  type: string
                  description: 去除的字符
            number_settings:
              type: object
              description: 数字类型转换配置
            datetime_settings:
              type: object
              description: 时间类型转换配置
              properties:
                format:
                  type: string
                  description: >-
                    日期时间格式，参考 DocFlow 日期格式说明
                    (https://docflow.textin.com/markdown?key=dateFormatGuide)
            enumerate_settings:
              type: object
              description: 枚举类型转换配置
              properties:
                items:
                  type: array
                  description: 可选枚举值列表
                  items:
                    type: string
            regex_settings:
              type: object
              description: 正则类型转换配置
              properties:
                match:
                  type: string
                  description: 匹配用的正则表达式
                replace:
                  type: string
                  description: 替换用的正则表达式
            mismatch_action:
              type: object
              description: 字段值不匹配时的处理动作，例如替换为默认值或仅输出告警
              properties:
                mode:
                  type: string
                  description: 不匹配时的处理模式
                  enum:
                    - default
                    - warning
                default_value:
                  type: string
                  description: 当模式为 default 时使用的默认值
    CategoryField:
      allOf:
        - $ref: '#/components/schemas/CategoryFieldConfig'
        - type: object
          properties:
            id:
              type: string
              description: 字段ID
              example: '1234567890'
    CategorySample:
      type: object
      description: 文件类别样本
      properties:
        sample_id:
          type: string
          description: 样本ID
          example: '1234567890'
        file_name:
          type: string
          description: 文件名
          example: invoice_sample.pdf
      required:
        - sample_id
        - file_name
    RiskLevel:
      type: integer
      description: |
        风险等级
        - 10: 高风险
        - 20: 中风险
        - 30: 低风险
      enum:
        - 10
        - 20
        - 30
    ReviewRuleField:
      type: object
      properties:
        field_id:
          type: string
          description: 字段ID
          example: '1234567890'
        field_name:
          type: string
          description: 字段名称
          example: 发票代码
    ReviewRuleReferencedField:
      type: object
      properties:
        category_id:
          type: string
          description: 分类ID
          example: '1234567890'
        category_name:
          type: string
          description: 分类名称
          example: 发票
        fields:
          type: array
          items:
            $ref: '#/components/schemas/ReviewRuleField'
        tables:
          type: array
          items:
            type: object
            properties:
              table_id:
                type: string
                description: 表格ID
                example: '1234567890'
              table_name:
                type: string
                description: 表格名称
                example: 发票表格
              fields:
                type: array
                items:
                  $ref: '#/components/schemas/ReviewRuleField'
    ReviewRule:
      type: object
      properties:
        rule_id:
          type: string
          description: 规则ID
          example: '31415926'
        name:
          type: string
          description: 规则名称
          example: 审核规则1
        prompt:
          type: string
          description: 规则提示词
          example: 审核规则提示词
        category_ids:
          type: array
          items:
            type: string
            description: 分类ID
            example: '1234567890'
        risk_level:
          $ref: '#/components/schemas/RiskLevel'
        referenced_fields:
          type: array
          items:
            $ref: '#/components/schemas/ReviewRuleReferencedField'
    ReviewRuleGroup:
      type: object
      properties:
        group_id:
          type: string
          description: 规则组ID
          example: '31415926'
        name:
          type: string
          description: 规则组名称
          example: 审核规则组1
        rules:
          type: array
          items:
            $ref: '#/components/schemas/ReviewRule'
    ReviewRuleRepo:
      type: object
      properties:
        repo_id:
          type: string
          description: 审核规则库ID
          example: '31415926'
        name:
          type: string
          description: 审核规则库名称
          example: 审核规则库1
        groups:
          description: 规则库下的规则组列表
          type: array
          items:
            $ref: '#/components/schemas/ReviewRuleGroup'
        category_ids:
          type: array
          items:
            type: string
            description: 分类ID
            example: '1234567890'
    ReviewRuleProperties:
      type: object
      properties:
        group_id:
          type: string
          description: 审核规则组ID
          example: '31415926'
        name:
          type: string
          description: 规则名称
          example: 审核规则1
        prompt:
          type: string
          description: 规则提示词
          example: 审核规则提示词
        category_ids:
          type: array
          items:
            type: string
            description: 分类ID
            example: '1234567890'
        risk_level:
          $ref: '#/components/schemas/RiskLevel'
        referenced_fields:
          type: array
          items:
            $ref: '#/components/schemas/ReviewRuleReferencedField'
    ReviewTaskStatus:
      type: integer
      description: |
        任务状态
        - 0: 未审核
        - 1: 审核通过
        - 2: 审核失败
        - 3: 审核中
        - 4: 审核不通过
        - 5: 识别中
        - 6: 排队中
        - 7: 识别失败
      enum:
        - 0
        - 1
        - 2
        - 3
        - 4
        - 5
        - 6
        - 7
security:
  - ApiId: []
    SecretCode: []
